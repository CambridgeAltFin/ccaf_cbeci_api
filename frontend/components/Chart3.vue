<template>
    <v-flex>
        <highcharts :constructor-type="'stockChart'" :options="{
        chart: {
          marginBottom: (containerWidth > 400) ? 120 : 0,
          marginLeft: (containerWidth > 400) ? 100 : 0,
          marginRight: (containerWidth > 400) ? 100 : 0,
          height: (containerWidth > 400) ? '56%' : 300,
          width: (containerWidth > 400) ? containerWidth * 0.9 : containerWidth
        },
        title: {
            text: 'Profitability threshold over time, J/Gh',
            align: 'left'
        },
        xAxis: {
            type: 'datetime'
        },
        yAxis: {
            title: {
                text: null
            },
            max: 2.5,
            type: 'logarithmic',
            opposite: false
        },
        tooltip: {
            formatter: function () {
              const point = this.points[0]
              return charts.dateFormat('%B %Y', this.x) + '<br/>' +
              '<b>' + point.series.name + '</b>' + ': ' + charts.numberFormat(point.y, 2) + ' J/Gh' + '<br/>';
              // '<b>' + 'BTC price' + '</b>' + ': $' + point.nameBtc;
            },
            shared: true
        },
        legend: {
            enabled: false
        },
        plotOptions: {
            series: {
                showInNavigator: (containerWidth > 400),
                marker: {
                    enabled: false,
                    states: {
                        hover: {
                            enabled: true,
                            radius: 3
                        }
                    }
                }
            }
        },
        navigator: {
            enabled: false
        },
        scrollbar: {
            enabled: false
        },
        rangeSelector: {
            enabled: false,
        },
        series: [
          {
            name: 'Profitability',
            color: '#ffb81c',
            data: data,
          }
        ],
        exporting: {
            enabled: false
        }
      }" />
    </v-flex>
</template>

<script>
    import {Chart} from 'highcharts-vue'
    import charts from 'highcharts'
    import stockInit from 'highcharts/modules/stock'

    stockInit(charts)

    export default {
        name: 'Chart3',
        components: {
            highcharts: Chart,
        },
        data() {
            return {
                containerWidth: 1000,
                data: this.parseDate([
                    ["12/1/14",285000,340.96,39800000000,37503937.65,25,3.59,3.6  ],
                    ["01/1/15",302000,246.63,42400000000,27300093.42,25,2.44,2.47  ],
                    ["02/1/15",339000,233.36,44000000000,27741813.33,25,2.22,2.23  ],
                    ["03/1/15",348000,268.17,47100000000,30462424.92,25,2.39,2.39  ],
                    ["04/1/15",345000,233.5,48600000000,25500198.44,25,2.01,2.02  ],
                    ["05/1/15",351000,237.7,48200000000,26655341.72,25,2.07,2.07  ],
                    ["06/1/15",364000,235.76,48800000000,27120043.99,25,2.03,2.04  ],
                    ["07/1/15",369000,277.86,50800000000,31225615.24,25,2.29,2.31  ],
                    ["08/1/15",377000,251.57,53100000000,27467529.88,25,1.99,1.99  ],
                    ["09/1/15",433000,234.48,57700000000,27251610.62,25,1.7,1.72  ],
                    ["10/1/15",432000,263.52,61000000000,28876033.3,25,1.81,1.83  ],
                    ["11/1/15",515000,348.12,65800000000,42107186.75,25,2.22,2.23  ],
                    ["12/1/15",666000,420.92,85400000000,50925206.73,25,2.07,2.09  ],
                    ["01/1/16",855000,411.8,111000000000,49073774.1,25,1.56,1.57  ],
                    ["02/1/16",1160000,404.99,147000000000,49572009.9,25,1.16,1.17  ],
                    ["03/1/16",1180000,414.32,162000000000,46729824.7,25,1.07,1.08  ],
                    ["04/1/16",1320000,435,174000000000,51665032.75,25,1.05,1.07  ],
                    ["05/1/16",1430000,455.94,190000000000,53060236.95,25,1,1.02  ],
                    ["06/1/16",1480000,639.24,201000000000,73714794.25,25,1.33,1.36  ],
                    ["07/1/16",1510000,656.19,212000000000,46001536.27,12.5,0.65,0.83  ],
                    ["08/1/16",1610000,579.18,210000000000,33906341.57,12.5,0.58,0.57  ],
                    ["09/1/16",1700000,606.88,227000000000,34915329.45,12.5,0.56,0.56  ],
                    ["10/1/16",1820000,642.83,253000000000,35587082.8,12.5,0.53,0.54  ],
                    ["11/1/16",1950000,725.98,266000000000,41381786.95,12.5,0.57,0.58  ],
                    ["12/1/16",2310000,825.55,300000000000,49184555.09,12.5,0.58,0.58  ],
                    ["01/1/17",2760000,895.22,348000000000,55412845.3,12.5,0.54,0.55  ],
                    ["02/1/17",3280000,1064.76,425000000000,65857040.28,12.5,0.52,0.55  ],
                    ["03/1/17",3460000,1126.45,468000000000,69187392.27,12.5,0.5,0.55  ],
                    ["04/1/17",3850000,1238.65,513000000000,77520090.15,12.5,0.51,0.55  ],
                    ["05/1/17",4370000,1881.09,559000000000,131165039.6,12.5,0.7,0.82  ],
                    ["06/1/17",5000000,2645.85,684000000000,174537851.3,12.5,0.81,0.95  ],
                    ["07/1/17",6120000,2526.12,768000000000,163377032,12.5,0.69,0.73  ],
                    ["08/1/17",6170000,3882.74,896000000000,228396535.5,12.5,0.91,1.01  ],
                    ["09/1/17",7910000,4165.2,1000000000000,261550965.8,12.5,0.87,0.9  ],
                    ["10/1/17",9440000,5334.01,1220000000000,335158982.6,12.5,0.92,0.97  ],
                    ["11/1/17",10100000,7821.41,1390000000000,502128359.5,12.5,1.18,1.36  ],
                    ["12/1/17",13200000,15371.38,1650000000000,1211532316,12.5,1.95,2.51  ],
                    ["01/1/18",17200000,12867.49,2200000000000,936937601.9,12.5,1.23,1.49  ],
                    ["02/1/18",22300000,9509.36,2860000000000,570448135.4,12.5,0.7,0.7  ],
                    ["03/1/18",24400000,9103.07,3320000000000,513690543.5,12.5,0.57,0.58  ],
                    ["04/1/18",28300000,7865.12,3690000000000,461837405,12.5,0.45,0.45  ],
                    ["05/1/18",32500000,8418.86,4140000000000,503941770.5,12.5,0.43,0.42  ],
                    ["06/1/18",37200000,6786.02,4930000000000,392282152,12.5,0.29,0.29  ],
                    ["07/1/18",38700000,7149,5350000000000,396599292.8,12.5,0.28,0.28  ],
                    ["08/1/18",48400000,6636.27,6310000000000,393227792.3,12.5,0.22,0.22  ],
                    ["09/1/18",51700000,6623.62,7000000000000,378670355.8,12.5,0.2,0.2  ],
                    ["10/1/18",53000000,6486.9,7290000000000,364614005.1,12.5,0.19,0.19  ],
                    ["11/1/18",44300000,5352.97,6920000000000,269776358.3,12.5,0.16,0.17  ],
                    ["12/1/18",37700000,3726.9,5490000000000,204145509.7,12.5,0.14,0.15  ],
                    ["01/1/19",43200000,3685.88,5770000000000,214313581.4,12.5,0.13,0.14  ],
                    ["02/1/19",45600000,3678.42,5970000000000,218066463.1,12.5,0.13,0.13  ],
                    ["03/1/19",44400000,3954.86,6160000000000,222604073.1,12.5,0.13,0.14  ],
                    ["04/1/19",45700000,5166.37,6380000000000,297737452.9,12.5,0.17,0.18  ],
                    ["05/1/19",50500000,5644.96,6580000000000,455824628.9,12.5,0.18,0.25  ]
                ])
            }
        },
        async mounted() {
            this.containerWidth = document.getElementById("wrap-container2").getBoundingClientRect().width
        },
        computed: {
            charts() {
                return charts
            },
        },
        methods: {
            parseDate(date) {
                return date.map((el)=> {
                    return {
                        x: (new Date(el[0])).getTime(),
                        y: el[7],
                        btc: el[2],
                    }
                })
            },
        }
    }
</script>
